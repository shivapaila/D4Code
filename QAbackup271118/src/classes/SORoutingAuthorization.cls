public class SORoutingAuthorization
{

    
    public class oAuthJson{
        public String token_type;   //Bearer
        public String scope;    //user_impersonation
        public String expires_in;   //3599
        public String ext_expires_in;   //0
        public String expires_on;   //1526296254
        public String not_before;   //1526292354
        public String resource; //https://5a9d9cfd-c32e-4ac1-a9ed-fe83df4f9e4d/cara-api-dev
        public String access_token; //eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImlCakwxUmNxemhpeTRmcHhJeGRacW9oTTJZayIsImtpZCI6ImlCakwxUmNxemhpeTRmcHhJeGRacW9oTTJZayJ9.eyJhdWQiOiJodHRwczovLzVhOWQ5Y2ZkLWMzMmUtNGFjMS1hOWVkLWZlODNkZjRmOWU0ZC9jYXJhLWFwaS1kZXYiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC81YTlkOWNmZC1jMzJlLTRhYzEtYTllZC1mZTgzZGY0ZjllNGQvIiwiaWF0IjoxNTI2MjkyMzU0LCJuYmYiOjE1MjYyOTIzNTQsImV4cCI6MTUyNjI5NjI1NCwiYWNyIjoiMSIsImFpbyI6IkFTUUEyLzhIQUFBQWZISkpVY2l3K1dQcDh2VmRlTmJ5eVRhanR1NVpVR0RFdjdQMUZKQjEvcTA9IiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6ImQzZTE1ZTRhLTU1ODQtNGYxZC1iZGM4LTA0MDBmMjg5ZmMyYyIsImFwcGlkYWNyIjoiMSIsImZhbWlseV9uYW1lIjoic19DUk1EZXZDYXJhIiwiaXBhZGRyIjoiMTE3LjIxNi4yMTkuMjEiLCJuYW1lIjoic19DUk1EZXZDYXJhIiwib2lkIjoiY2Q2ZjY2ZjAtN2E0ZC00N2Q4LWI1MzctMGJlZDEyOTM3NjMxIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTMzOTIyMDYwNzgtNzE4NDA1MTMxLTMwMTMyODEyNDQtMjQzMzI5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiaW1kTzBYRjNpOGlLeWE4eEI0NDJJSUxXTDlzSG5mRUdSVkJPVnJXQTVFbyIsInRpZCI6IjVhOWQ5Y2ZkLWMzMmUtNGFjMS1hOWVkLWZlODNkZjRmOWU0ZCIsInVuaXF1ZV9uYW1lIjoic19DUk1EZXZDYXJhQGFzaGxleWZ1cm5pdHVyZS5jb20iLCJ1cG4iOiJzX0NSTURldkNhcmFAYXNobGV5ZnVybml0dXJlLmNvbSIsInV0aSI6IkxkYUdmTTNKNGtLaWNGcFlsbmNkQUEiLCJ2ZXIiOiIxLjAifQ.OlVn2uqNxZ2IkEn_6w8y0EL7l8bir7IbHc3mqGmyGUWdCXQjy4mVfSCqsG90t7kE3v2FeFHFWFu4T595UJoTs7JlyDini9UMo03R5wPUNjzn4Mc-VYsnR9P-YyMswGLYpRpycDj8VF9llc9Vw1d5P-nHHAeeBn0eGA-5XzHILsKSsNXpF_1unhZg_6DLWnu-lLxchmBZ9AY_9YIXt8e3--hMtsB6Nx5AT1TfuX85UAhkIhBAd5Lky7JOteAcg2OeixVVeqC2-xV4G9CskwpYRLJCikO3GFoLAT9tapVq7gQUCoHfefahHe8mNPM9n6tjs0x6cC3nAEvI3klY-wbfCg
        public String refresh_token;    //AQABAAAAAADX8GCi6Js6SK82TsD2Pb7redb7cr5uZXnok0Uv8CVP_3R_dxKdmNmgHJMo1aYPohEQXX26WPnWDlQh9S1y-KNPPHmjvuFrWa6KbmDvmL_FQ-__6tYGitU8sS2MC2r1Zj6CVQzgtvPPHAnAhY-oho_aSqyGx1phvrRw7vERG2zAAeqG9CLQqtHr8MSyo1NTxuz72MUTeeTjdDcMUtso6fJ0TTMysprM9Z0-C9fURzratBbubBN6Yhdnufu9sPiJPUO5NAlb7hjfBbayIqiDe_FEHGRtyJ-VHDl9x_nUBWo4Awy9oZciITK8-_jNMyd6pzA4wgDzkNKpabjaRFthmE4e73QrMWlwFkSeqwG4YrOrzIWttNZiIPwFCZK3xKsTNojDwmFiUAcBXp4dmlXGcbUGOf_Zm0qb0bXevli7cMs4B57GHhJkCTki9XqNsvshEd-vlECTgMHxjtch0GlqrzaRtE4iFraLrotCDTbJmdStdAuLzH-RrPIUfKnBYyZZ9uWHsNSGZal6hdcxAmQUwbullCtGTC8RcNBwSvOWSp5KVwmFABN6B6mW6E-jYujNtXCNVjswMmihlhoFa11qm8BM9QXlbn2How1Puulryt6fJSEHQ0tI-_x-n54XRjvm91uioSEMnH79PuhSP6yPlWJepL5Au0u3dNnH-wpUAr1ShNwQ2JTTpL1WhZs8SOzrSoK2lofKCDKRgG2reQMBRJjpRcX3DZszc_-lfnqoRPwXG5Qm5gnJdJ62u4_5mnsLooELpVsm-E2xTPWNIL1RCT7BIAA
        public String id_token; //eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdWQiOiJkM2UxNWU0YS01NTg0LTRmMWQtYmRjOC0wNDAwZjI4OWZjMmMiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC81YTlkOWNmZC1jMzJlLTRhYzEtYTllZC1mZTgzZGY0ZjllNGQvIiwiaWF0IjoxNTI2MjkyMzU0LCJuYmYiOjE1MjYyOTIzNTQsImV4cCI6MTUyNjI5NjI1NCwiYW1yIjpbInB3ZCJdLCJmYW1pbHlfbmFtZSI6InNfQ1JNRGV2Q2FyYSIsImlwYWRkciI6IjExNy4yMTYuMjE5LjIxIiwibmFtZSI6InNfQ1JNRGV2Q2FyYSIsIm9pZCI6ImNkNmY2NmYwLTdhNGQtNDdkOC1iNTM3LTBiZWQxMjkzNzYzMSIsIm9ucHJlbV9zaWQiOiJTLTEtNS0yMS0zMzkyMjA2MDc4LTcxODQwNTEzMS0zMDEzMjgxMjQ0LTI0MzMyOSIsInN1YiI6IkNVNUtYNFU3cUwyRFFMNzk5RlJSUVkyWTZyMFMta3Ftd3hyUDhmLVo4R2MiLCJ0aWQiOiI1YTlkOWNmZC1jMzJlLTRhYzEtYTllZC1mZTgzZGY0ZjllNGQiLCJ1bmlxdWVfbmFtZSI6InNfQ1JNRGV2Q2FyYUBhc2hsZXlmdXJuaXR1cmUuY29tIiwidXBuIjoic19DUk1EZXZDYXJhQGFzaGxleWZ1cm5pdHVyZS5jb20iLCJ2ZXIiOiIxLjAifQ.
    }
    
    public String accessTokenData()
    {
           String body = 'grant_type='+ Label.Ashley_ReplacementParts_grant_type;
              
            body += '&client_secret=' + EncodingUtil.urlEncode(Label.Ashley_RoutingClientSecret, 'UTF-8');
            body += '&client_id=' + EncodingUtil.urlEncode(Label.Ashley_RoutingClientId, 'UTF-8');
            body += '&scope=' + EncodingUtil.urlEncode('openid', 'UTF-8');
            body += '&resource=' + EncodingUtil.urlEncode(Label.Ashley_Routingresource, 'UTF-8');
            body += '&username=' + EncodingUtil.urlEncode(Label.Ashley_RoutingUserName, 'UTF-8');
            body += '&password=' + EncodingUtil.urlEncode(Label.Ashley_RoutingPassword, 'UTF-8');
           
            String ePnt =  Label.Ashley_TokenGenerationURL;
                    
        	Http http = new Http();
            HttpRequest httpReq = new HttpRequest();
            HttpResponse httpResp = new HttpResponse();
            httpReq.setEndpoint(ePnt);
            httpReq.setBody(body);
            httpReq.setHeader('Content-Type', 'application/x-www-form-urlencoded');
            httpReq.setMethod('POST');  
            httpResp = http.send(httpReq); 
            system.debug('resp-------'+httpResp.getBody());
            
           oAuthJson oaJson = (oAuthJson)JSON.deserialize(httpResp.getBody(), oAuthJson.class); 
            system.debug('resp_access_token-------'+oaJson.access_token); 
           return oaJson.access_token;
    }
}